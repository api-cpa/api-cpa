sudo: required

language: ruby

services:
  - docker

# skip installation step (tests run into docker containers)
install: true

# prepare environment variables
# stop postgres default travis service
# build app
before_script:
  - cp .env.travis .env
  - sudo /etc/init.d/postgresql stop
  - docker-compose build
  - docker-compose run -e "RAILS_ENV=test" baasile_io "sleep 10 && rails db:setup"

# run tests
script:
  - docker-compose run -e "RAILS_ENV=test" baasile_io rspec
