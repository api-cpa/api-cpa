<%
  output ||= []
  input ||= []
%>

<% if input.size > 0 %>
  <hr>
  <h5>Requêtes envoyées</h5>
  <table class="table table-sm">
    <thead>
    <tr>
      <th>Date</th>
      <th>Contrat</th>
      <th>Client</th>
      <th>Produit</th>
      <th>Route</th>
      <th>MeasureToken</th>
      <th>Nbre</th>
    </tr>
    </thead>
    <tbody>
    <% input.each do |m| %>
      <tr>
        <td><%= m.created_at.strftime('%Y/%m/%d') %></td>
        <td>
          <%= m.contract.try(:name) %> <br />
          <%= m.contract_status %>
        </td>
        <td><%= m.client.try(:name) %></td>
        <td>
          <%= m.service.try(:name) %><br />
          <%= m.proxy.try(:name) %>
        </td>
        <td><%= m.route.try(:name) %></td>
        <td><%= m.measure_token.try(:value) %></td>
        <td><%= m.requests_count %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if output.size > 0 %>
  <hr>
  <h5>Requêtes reçues</h5>
  <table class="table table-sm">
    <thead>
    <tr>
      <th>Date</th>
      <th>Contrat</th>
      <th>Client</th>
      <th>Produit</th>
      <th>Route</th>
      <th>MeasureToken</th>
      <th>Nbre</th>
    </tr>
    </thead>
    <tbody>
    <% output.each do |m| %>
      <tr>
        <td><%= m.created_at.strftime('%Y/%m/%d') %></td>
        <td>
          <%= m.contract.try(:name) %> <br />
          <%= m.contract_status %>
        </td>
        <td><%= m.client.try(:name) %></td>
        <td>
          <%= m.service.try(:name) %><br />
          <%= m.proxy.try(:name) %>
        </td>
        <td><%= m.route.try(:name) %></td>
        <td><%= m.measure_token.try(:value) %></td>
        <td><%= m.requests_count %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>