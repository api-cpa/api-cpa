<div class="ui container">
  <% include ./_header %>

  <% if (data.route.fields.length == 0) { %>
  <div class="ui tertiary inverted red segment">
    <p>Attention, votre collection ne comporte aucun champ !</p>
  </div>
  <% } %>
  <div class="ui segment">
    <button class="<% if (dataCount == 0) { %>disabled<% } %> ui button" id="drop_database_modal_btn">
      <i class="trash icon"></i>
      Supprimer les données
    </button>
    <button class="ui button" id="remove_database_modal_btn">
      <i class="trash icon"></i>
      Détruire la collection
    </button>
    <br >
    <div class="ui statistic">
      <div class="value">
        <%= dataCount %>
      </div>
      <div class="label">
        Donnée(s)
      </div>
    </div>
    <div class="ui statistic">
      <div class="value">
        <%= data.route.fields.length %>
      </div>
      <div class="label">
        Champ(s)
      </div>
    </div>
    <div class="ui statistic">
      <div class="value">
        <%= data.route.relations.length %>
      </div>
      <div class="label">
        Relation(s)
      </div>
    </div>
  </div>
  <% include ./_data_preview %>
  <% include ../../../partials/api_uri_list %>
</div>

<div class="ui basic modal" id="remove_database_modal">
  <div class="ui inverted icon header">
    <i class="trash icon"></i>
    <div class="content">
      Détruire la collection et toutes ses données
      <div class="sub header">
        Êtes-vous certain de vouloir détruire cette collection et l'ensemble de ses données ?
      </div>
    </div>
  </div>
  <div class="actions">
    <div class="ui center aligned basic segment">
      <div class="ui cancel red basic inverted button">
        <i class="remove icon"></i>
        Annuler
      </div>
      <div class="ui ok green basic inverted button" id="remove_database_btn">
        <i class="checkmark icon"></i>
        Confirmer
      </div>
    </div>
  </div>
</div>

<div class="ui basic modal" id="drop_database_modal">
  <div class="ui inverted icon header">
    <i class="trash icon"></i>
    <div class="content">
      Supprimer les données de la collection
      <div class="sub header">
        Êtes-vous certain de vouloir supprimer l'ensemble des données de cette collection ?
      </div>
    </div>
  </div>
  <div class="actions">
    <div class="ui center aligned basic segment">
      <div class="ui cancel red basic inverted button">
        <i class="remove icon"></i>
        Annuler
      </div>
      <div class="ui ok green basic inverted button" id="drop_database_btn">
        <i class="checkmark icon"></i>
        Confirmer
      </div>
    </div>
  </div>
</div>

<form id="drop_database_form" method="post" action="/dashboard/services/<%= data.service.nameNormalized %>/routes/<%= data.route.nameNormalized %>/drop">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
</form>

<script>
  $(document).ready(function() {
    $('#drop_database_btn').on('click', function(e) {
      document.getElementById('drop_database_form').submit();
    });
    $('#drop_database_modal_btn').on('click', function(e) {
      $('#drop_database_modal').modal('show');
    });
  });
</script>

<form id="remove_database_form" method="post" action="/dashboard/services/<%= data.service.nameNormalized %>/routes/<%= data.route.nameNormalized %>/remove">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
</form>

<script>
  $(document).ready(function() {
    $('#remove_database_btn').on('click', function(e) {
      document.getElementById('remove_database_form').submit();
    });
    $('#remove_database_modal_btn').on('click', function(e) {
      $('#remove_database_modal').modal('show');
    });
  });
</script>